<html>
  <head>
    <title>Babel</title>
    <style>canvas { width: 100%; height: 100% }</style>
  </head>
  <body>
<script type="x-shader/x-vertex" id="terrain-vertexShader">
  varying vec3 vNormal;
  varying vec3 vPosition;

  void main() {
    vNormal = normal;
    vPosition = position;
    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  }
</script>
<script type="x-shader/x-fragment" id="terrain-fragmentShader">
  varying vec3 vNormal;
  varying vec3 vPosition;

  vec2 blinnPhongDir(vec3 lightDir, float lightInt, float Ka, float Kd, float Ks, float shininess)
  {
    vec3 s = normalize(lightDir);
    vec3 v = normalize(-vPosition);
    vec3 n = normalize(vNormal);
    vec3 h = normalize(v+s);
    float diffuse = Ka + Kd * lightInt * max(0.0, dot(n, s));
    float spec =  Ks * pow(max(0.0, dot(n,h)), shininess);
    return vec2(diffuse, spec);
  }

  void main() {
    float threshold = 0.2;

    vec3 water = vec3(177.0/255.0, 180.0/255.0, 121.0/255.0);
    vec3 grass = vec3(123.0/255.0, 162.0/255.0, 63.0/255.0);
    vec3 dirt = vec3(125.0/255.0, 83.0/255.0, 44.0/255.0);
    if(vPosition.y > 3.0) {
      gl_FragColor = vec4(grass, 1.0) * blinnPhongDir(vec3(0, 2, 1), 1.0, 0.5, 0.5, 0.0, 0.0).x;
    } else {
      gl_FragColor = vec4(dirt, 1.0) * blinnPhongDir(vec3(0, 2, 1), 1.0, 0.5, 0.5, 0.0, 0.0).x;
    }
  }
</script>
<script type="x-shader/x-vertex" id="water-vertexShader">
  varying vec3 vNormal;
  varying vec3 vPosition;

  void main() {
    vNormal = normal;
    vPosition = position;
    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  }
</script>
<script type="x-shader/x-fragment" id="water-fragmentShader">
  varying vec3 vNormal;
  varying vec3 vPosition;

  vec2 blinnPhongDir(vec3 lightDir, float lightInt, float Ka, float Kd, float Ks, float shininess)
  {
    vec3 s = normalize(lightDir);
    vec3 v = normalize(-vPosition);
    vec3 n = normalize(vNormal);
    vec3 h = normalize(v+s);
    float diffuse = Ka + Kd * lightInt * max(0.0, dot(n, s));
    float spec =  Ks * pow(max(0.0, dot(n,h)), shininess);
    return vec2(diffuse, spec);
  }

  void main() {
    float threshold = 0.2;

    vec3 water = vec3(120.0/255.0, 194.0/255.0, 196.0/255.0);
    vec3 grass = vec3(123.0/255.0, 162.0/255.0, 63.0/255.0);
    vec3 dirt = vec3(125.0/255.0, 83.0/255.0, 44.0/255.0);
    gl_FragColor = vec4(water, 0.5) * blinnPhongDir(vec3(0, 2, 1), 1.0, 0.5, 0.5, 0.0, 0.0).x;
  }
</script>
    <script src="three.js"></script>
    <script src="threex.keyboardstate.js"></script>
    <script src="three.colladaloader.js"></script>
    <script src="SceneLoader.js"></script>
    <script data-main="game.js" src="require.js"></script>
  </body>
</html>